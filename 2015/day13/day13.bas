1 A=0
2 A0=ASC("\X9D")
3 A1$="\X91"
4 A2=ASC(" ")
5 A3=ASC(".")
6 A4=10
7 A5=VAL("1.70141183E38")
8 A6$=CHR$($6C)+CHR$($6F)+CHR$($73)+CHR$($65)
9 A7$="INPUT.TXT"
10 CLS
11 PRINT"INPUT FILENAME: "A7$RPT$(A0,LEN(A7$));
12 LINPUTA8$
13 OPEN1,8,2,A8$
14 OPEN15,8,15
15 INPUT#15,A9,AA$,AB,AC
16 CLOSE15
17 IFA9THENCLOSE1:PRINTAD$:PRINT:GOTO11
18 AE=TI
19 AF=0
20 LINPUT#1,AG$,A4
21 IFST AND64THEN24
22 AF=AF+2
23 GOTO20
24 CLOSE1
25 DIMAH$(AF-1)
26 DIMAI%(AF-1,AF-1)
27 AJ=0
28 OPEN1,8,2,A8$
29 LINPUT#1,AK$,A2
30 IFATHENAL$=AK$:GOSUB89:AK$=AM$
31 IFST AND64THEN56
32 IFAJ=0THEN36
33 FORAN=0TOAJ-1
34 IFAH$(AN)=AK$THENAK=AN:GOTO39
35 NEXTAN
36 AH$(AJ)=AK$
37 AK=AJ
38 AJ=AJ+1
39 LINPUT#1,AO$,A2
40 LINPUT#1,AP$,A2
41 LINPUT#1,AQ$,A2
42 FORAN=1TO6:LINPUT#1,AO$,A2:NEXTAN
43 LINPUT#1,AR$,A3
44 IFATHENAL$=AR$:GOSUB89:AR$=AM$
45 GET#1,AO$
46 FORAN=0TOAJ-1
47 IFAH$(AN)=AR$THENAR=AN:GOTO52
48 NEXTAN
49 AH$(AJ)=AR$
50 AR=AJ
51 AJ=AJ+1
52 AQ=VAL(AQ$)
53 IFAP$=A6$THENAQ=-AQ
54 AI%(AK,AR)=AQ
55 GOTO29
56 CLOSE1
57 DIMAS%(AJ)
58 AT=1
59 PRINT"PART"AT" -";
60 AJ=AJ+AT-1
61 AU=1
62 FORAN=1TOAJ-1:
63 AU=AU*AN
64 NEXTAN
65 PRINTAJ"GUESTS, MAKING"AU"POSSIBLE SEATING ARRANGEMENTS."
66 FORAN=0TOAJ-1
67 AS%(AN)=AN
68 NEXTAN
69 AV=-A5
70 FORAW=0TOAU-1
71 PRINTAW;A1$
72 AX=0
73 FORAN=0TOAJ-2
74 AK=AS%(AN)
75 AR=AS%(AN+1)
76 AX=AX+AI%(AK,AR)
77 AX=AX+AI%(AR,AK)
78 NEXTAN
79 AX=AX+AI%(AR,AS%(0))
80 AX=AX+AI%(AS%(0),AR)
81 IFAX>AVTHENAV=AX
82 GOSUB96
83 NEXTAW
84 PRINT"BEST SCORE:"AV
85 AT=AT+1
86 IFAT<3THEN59
87 PRINT"COMPUTED IN"(TI-AE)"JIFFIES."
88 END
89 AM$=""
90 FORAY=1TOLEN(AL$)
91 AZ=ASC(MID$(AL$,AY))
92 IFAZ>96ANDAZ<128THENAZ=AZ-32
93 AM$=AM$+CHR$(AZAND127)
94 NEXTAY
95 RETURN
96 B=AJ-2
97 IFAS%(B)<AS%(B+1)THEN101
98 B=B-1
99 IFB>=1THEN97
100 RETURN
101 B0=AJ-1
102 IFAS%(B0)>AS%(B)THEN105
103 B0=B0-1
104 GOTO102
105 B1%=AS%(B)
106 AS%(B)=AS%(B0)
107 AS%(B0)=B1%
108 B2=AJ-1-B
109 FORB3=0TOINT(B2/2)-1
110 B4=B+1+B3
111 B0=AJ-1-B3
112 B1%=AS%(B4)
113 AS%(B4)=AS%(B0)
114 AS%(B0)=B1%
115 NEXTB3
116 RETURN
117 PRINTAH$(AS%(0));
118 FORAN=1TOAJ-1
119 PRINT", "AH$(AS%(AN));
120 NEXTAN
121 PRINT
122 RETURN
